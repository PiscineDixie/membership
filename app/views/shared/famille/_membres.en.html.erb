<div id="membres">
<p>
  Include an entry for each member of the family (child, parent, grand-parent) living at the same address.
  The birthdates are important for the income tax receipts and discounts for senior (65 year-old on August 1st).
</p>
<p id="head">
  <label id="prenom">Firstname</label>
  <label id="nom">Surname</label>
  <label id="naissance">Birthday</label>
  <label id="ecusson">Badge <%= link_to '(Help)', 'http://www.piscinedixiepool.com/badges', :popup => ['ecussons', 'width=600,height=600'] -%></label>
</p>
<div id="liste_membres">
<% idx = 0 %>
<% @famille.membres.each do | membre | %>
  <div id="membres_<%= idx.to_s %>" class="membre">
    <div class="info">
      <%= hidden_field_tag "famille[membres][" + idx.to_s + "][id]", membre.id, :size => 0 %>
      <span id="membres_<%= idx.to_s %>_rangee" class="head"><%= (idx+1).to_s + "." %></span>
      <%= text_field_tag "famille[membres][" + idx.to_s + "][prenom]", membre.prenom, :size => 10, :class => "prenom" %>
      <%= text_field_tag "famille[membres][" + idx.to_s + "][nom]", membre.nom, :size => 10, :class => "nom" %>
      <span class="naissance">
        <%= select_date membre.naissance, :prefix => "famille[membres][" + idx.to_s + "][naissance]", :start_year => 1910, :end_year => Date.today.year, :use_month_names => %w(Jan Fév Mar Avr Mai Juin Juil Août Sept Oct Nov Déc)%>
      </span><%= select_tag "famille[membres][" + idx.to_s + "][ecusson]", options_for_select(Membre::Ecussons, membre.ecusson), :class => 'ecusson' %>
    </div>
    <div class="acts">
      <!-- Ecrire les activites dans une tables de 3 colonnes -->
      <table class="actstbl"><colgroup><col id="act1box"/><col id="act1"/><col id="act2box"/><col id="act2"/><col id="act3box"/><col id="act3"/></colgroup><tbody><tr>
      <% colIdx = 0 %>
      <% Activite.order(:code).each do | act | %>
        <% if colIdx == 3 then %>
          </tr><tr>
          <% colIdx = 1 %>
        <% else %>
          <% colIdx = colIdx + 1 %>
        <% end %>
        <td><%= check_box_tag "famille[membres][" + idx.to_s + "][activites]["+act.code+"]", act.id, membre.activite?(act.id), :class => "box" %></td>
        <td><%= link_to act.description_en, act.url_en, :class => 'label', :popup => [act.description_en.delete(' -'), 'width=600,height=600'] %></td>
      <% end%>
      </tr></tbody></table>
    </div>
    <div class="member-footer">
      <span class="enlBouton"><button id="enlBouton_<%= idx.to_s %>" type="submit" >Remove member</button></span>
      <span id="LN_details_membres_<%= idx.to_s %>" class="LN_details">
        <%= select_tag "famille[membres][" + idx.to_s + "][cours_de_natation]", options_for_select(['Niveau natation'].concat(Activite::CoursDeNatation), membre.cours_de_natation) %>
        <%= select_tag "famille[membres][" + idx.to_s + "][session_de_natation]", options_for_select(['Horaire'].concat(Activite::SessionCoursDeNatation), membre.session_de_natation) %>
      </span>
    </div>
  </div>
  <% idx = idx + 1 %>
<% end %>
</div> <!-- liste_membres -->
<button id="boutonAjouterMembre" type="button">Add a new member</button>
<button id="lnk_participations" type="button">Next section</button>
</div>
